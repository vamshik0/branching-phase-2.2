{
  "id": "c8af71d2-2f96-4e95-9b19-c28639630a93",
  "name": "createRewardRequestGenerator",
  "options": {
    "code": "const rewardNameMap = {\n  \"Reward 1\": rewardNameInput1.value,\n  \"Reward 2\": rewardNameInput2.value,\n  \"Reward 3\": rewardNameInput3.value,\n  \"Reward 4\": rewardNameInput4.value,\n  \"Reward 5\": rewardNameInput5.value,\n};\n\nconst rewardDescriptionMap = {\n  \"Reward 1\": rewardDescriptionInput1.value,\n  \"Reward 2\": rewardDescriptionInput2.value,\n  \"Reward 3\": rewardDescriptionInput3.value,\n  \"Reward 4\": rewardDescriptionInput4.value,\n  \"Reward 5\": rewardDescriptionInput5.value,\n};\n\nconst rewardTypeMap = {\n  \"Reward 1\": rewardTypeInput1.value,\n  \"Reward 2\": rewardTypeInput2.value,\n  \"Reward 3\": rewardTypeInput3.value,\n  \"Reward 4\": rewardTypeInput4.value,\n  \"Reward 5\": rewardTypeInput5.value,\n};\n\nconst rewardOfferTemplateIdMap = {\n  \"Reward 1\": rewardOfferTemplateId1.value,\n  \"Reward 2\": rewardOfferTemplateId2.value,\n  \"Reward 3\": rewardOfferTemplateId3.value,\n  \"Reward 4\": rewardOfferTemplateId4.value,\n  \"Reward 5\": rewardOfferTemplateId5.value,\n};\n\nconst rewardLockedHeadingMap = {\n  \"Reward 1\": rewardLockedHeading1.value,\n  \"Reward 2\": rewardLockedHeading2.value,\n  \"Reward 3\": rewardLockedHeading3.value,\n  \"Reward 4\": rewardLockedHeading4.value,\n  \"Reward 5\": rewardLockedHeading5.value,\n};\n\nconst rewardLockedDescriptionMap = {\n  \"Reward 1\": rewardLockedDescription1.value,\n  \"Reward 2\": rewardLockedDescription2.value,\n  \"Reward 3\": rewardLockedDescription3.value,\n  \"Reward 4\": rewardLockedDescription4.value,\n  \"Reward 5\": rewardLockedDescription5.value,\n};\n\nconst rewardLockedCtaCalloutMap = {\n  \"Reward 1\": rewardLockedCtaCallout1.value,\n  \"Reward 2\": rewardLockedCtaCallout2.value,\n  \"Reward 3\": rewardLockedCtaCallout3.value,\n  \"Reward 4\": rewardLockedCtaCallout4.value,\n  \"Reward 5\": rewardLockedCtaCallout5.value,\n};\n\nconst rewardLockedCtaLinkMap = {\n  \"Reward 1\": rewardLockedCtaLink1.value,\n  \"Reward 2\": rewardLockedCtaLink2.value,\n  \"Reward 3\": rewardLockedCtaLink3.value,\n  \"Reward 4\": rewardLockedCtaLink4.value,\n  \"Reward 5\": rewardLockedCtaLink5.value,\n};\n\nconst rewardUnlockedHeadingMap = {\n  \"Reward 1\": rewardUnlockedHeading1.value,\n  \"Reward 2\": rewardUnlockedHeading2.value,\n  \"Reward 3\": rewardUnlockedHeading3.value,\n  \"Reward 4\": rewardUnlockedHeading4.value,\n  \"Reward 5\": rewardUnlockedHeading5.value,\n};\n\nconst rewardUnlockedDescriptionMap = {\n  \"Reward 1\": rewardUnlockedDescription1.value,\n  \"Reward 2\": rewardUnlockedDescription2.value,\n  \"Reward 3\": rewardUnlockedDescription3.value,\n  \"Reward 4\": rewardUnlockedDescription4.value,\n  \"Reward 5\": rewardUnlockedDescription5.value,\n};\n\nconst rewardUnlockedCtaCalloutMap = {\n  \"Reward 1\": rewardUnlockedCtaCallout1.value,\n  \"Reward 2\": rewardUnlockedCtaCallout2.value,\n  \"Reward 3\": rewardUnlockedCtaCallout3.value,\n  \"Reward 4\": rewardUnlockedCtaCallout4.value,\n  \"Reward 5\": rewardUnlockedCtaCallout5.value,\n};\n\nconst rewardUnlockedCtaLinkMap = {\n  \"Reward 1\": rewardUnlockedCtaLink1.value,\n  \"Reward 2\": rewardUnlockedCtaLink2.value,\n  \"Reward 3\": rewardUnlockedCtaLink3.value,\n  \"Reward 4\": rewardUnlockedCtaLink4.value,\n  \"Reward 5\": rewardUnlockedCtaLink5.value,\n};\n\nconst rewardRedeemedHeadingMap = {\n  \"Reward 1\": rewardRedeemedHeading1.value,\n  \"Reward 2\": rewardRedeemedHeading2.value,\n  \"Reward 3\": rewardRedeemedHeading3.value,\n  \"Reward 4\": rewardRedeemedHeading4.value,\n  \"Reward 5\": rewardRedeemedHeading5.value,\n};\n\nconst rewardRedeemedDescriptionMap = {\n  \"Reward 1\": rewardRedeemedDescription1.value,\n  \"Reward 2\": rewardRedeemedDescription2.value,\n  \"Reward 3\": rewardRedeemedDescription3.value,\n  \"Reward 4\": rewardRedeemedDescription4.value,\n  \"Reward 5\": rewardRedeemedDescription5.value,\n};\n\nconst rewardRedeemedCtaCalloutMap = {\n  \"Reward 1\": rewardRedeemedCtaCallout1.value,\n  \"Reward 2\": rewardRedeemedCtaCallout2.value,\n  \"Reward 3\": rewardRedeemedCtaCallout3.value,\n  \"Reward 4\": rewardRedeemedCtaCallout4.value,\n  \"Reward 5\": rewardRedeemedCtaCallout5.value,\n};\n\nconst rewardRedeemedCtaLinkMap = {\n  \"Reward 1\": rewardRedeemedCtaLink1.value,\n  \"Reward 2\": rewardRedeemedCtaLink2.value,\n  \"Reward 3\": rewardRedeemedCtaLink3.value,\n  \"Reward 4\": rewardRedeemedCtaLink4.value,\n  \"Reward 5\": rewardRedeemedCtaLink5.value,\n};\n\nconst rewardExpiredHeadingMap = {\n  \"Reward 1\": rewardExpiredHeading1.value,\n  \"Reward 2\": rewardExpiredHeading2.value,\n  \"Reward 3\": rewardExpiredHeading3.value,\n  \"Reward 4\": rewardExpiredHeading4.value,\n  \"Reward 5\": rewardExpiredHeading5.value,\n};\n\nconst rewardExpiredDescriptionMap = {\n  \"Reward 1\": rewardExpiredDescription1.value,\n  \"Reward 2\": rewardExpiredDescription2.value,\n  \"Reward 3\": rewardExpiredDescription3.value,\n  \"Reward 4\": rewardExpiredDescription4.value,\n  \"Reward 5\": rewardExpiredDescription5.value,\n};\n\nconst rewardExpiredCtaCalloutMap = {\n  \"Reward 1\": rewardExpiredCtaCallout1.value,\n  \"Reward 2\": rewardExpiredCtaCallout2.value,\n  \"Reward 3\": rewardExpiredCtaCallout3.value,\n  \"Reward 4\": rewardExpiredCtaCallout4.value,\n  \"Reward 5\": rewardExpiredCtaCallout5.value,\n};\n\nconst rewardExpiredCtaLinkMap = {\n  \"Reward 1\": rewardExpiredCtaLink1.value,\n  \"Reward 2\": rewardExpiredCtaLink2.value,\n  \"Reward 3\": rewardExpiredCtaLink3.value,\n  \"Reward 4\": rewardExpiredCtaLink4.value,\n  \"Reward 5\": rewardExpiredCtaLink5.value,\n};\n\nconst rewardDurationMap = {\n  \"Reward 1\": rewardDuration1.value,\n  \"Reward 2\": rewardDuration2.value,\n  \"Reward 3\":rewardDuration3.value,\n  \"Reward 4\": rewardDuration4.value,\n  \"Reward 5\": rewardDuration5.value,\n};\n\nconst rewardRedeemOrderCountMap = {\n  \"Reward 1\": rewardRedeemOrderCount1.value,\n  \"Reward 2\": rewardRedeemOrderCount2.value,\n  \"Reward 3\": rewardRedeemOrderCount3.value,\n  \"Reward 4\": rewardRedeemOrderCount4.value,\n  \"Reward 5\": rewardRedeemOrderCount5.value,\n};\n\nconst rewardBusinessLineMap = {\n  \"Reward 1\": businessLineSelector1.value,\n  \"Reward 2\": businessLineSelector2.value,\n  \"Reward 3\": businessLineSelector3.value,\n  \"Reward 4\": businessLineSelector4.value,\n  \"Reward 5\": businessLineSelector5.value,\n};\n\nconst rewardName = rewardNameMap[steppedRewardContainer.currentViewKey]; // get the rewardName from current tab\nconst rewardDescription =\n  rewardDescriptionMap[steppedRewardContainer.currentViewKey];\nconst rewardType = rewardTypeMap[steppedRewardContainer.currentViewKey];\nconst rewardOfferTemplateId =\n  rewardOfferTemplateIdMap[steppedRewardContainer.currentViewKey];\nconst rewardLockedHeading =\n  rewardLockedHeadingMap[steppedRewardContainer.currentViewKey];\nconst rewardLockedDescription =\n  rewardLockedDescriptionMap[steppedRewardContainer.currentViewKey];\nconst rewardLockedCtaCallout =\n  rewardLockedCtaCalloutMap[steppedRewardContainer.currentViewKey];\nconst rewardLockedCtaLink =\n  rewardLockedCtaLinkMap[steppedRewardContainer.currentViewKey];\nconst rewardUnlockedHeading =\n  rewardUnlockedHeadingMap[steppedRewardContainer.currentViewKey];\nconst rewardUnlockedDescription =\n  rewardUnlockedDescriptionMap[steppedRewardContainer.currentViewKey];\nconst rewardUnlockedCtaCallout =\n  rewardUnlockedCtaCalloutMap[steppedRewardContainer.currentViewKey];\nconst rewardUnlockedCtaLink =\n  rewardUnlockedCtaLinkMap[steppedRewardContainer.currentViewKey];\nconst rewardRedeemedHeading =\n  rewardRedeemedHeadingMap[steppedRewardContainer.currentViewKey];\nconst rewardRedeemedDescription =\n  rewardRedeemedDescriptionMap[steppedRewardContainer.currentViewKey];\nconst rewardRedeemedCtaCallout =\n  rewardRedeemedCtaCalloutMap[steppedRewardContainer.currentViewKey];\nconst rewardRedeemedCtaLink =\n  rewardRedeemedCtaLinkMap[steppedRewardContainer.currentViewKey];\nconst rewardExpiredHeading =\n  rewardExpiredHeadingMap[steppedRewardContainer.currentViewKey];\nconst rewardExpiredDescription =\n  rewardExpiredDescriptionMap[steppedRewardContainer.currentViewKey];\nconst rewardExpiredCtaCallout =\n  rewardExpiredCtaCalloutMap[steppedRewardContainer.currentViewKey];\nconst rewardExpiredCtaLink =\n  rewardExpiredCtaLinkMap[steppedRewardContainer.currentViewKey];\nconst rewardDuration = rewardDurationMap[steppedRewardContainer.currentViewKey];\nconst rewardRedeemOrderCount = rewardRedeemOrderCountMap[steppedRewardContainer.currentViewKey];\nconst rewardBusinessLine = rewardBusinessLineMap[steppedRewardContainer.currentViewKey]\n\n// Function to generate UUID\nfunction generateUUID() {\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n    var r = (Math.random() * 16) | 0,\n      v = c === \"x\" ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n// Function to get current time in seconds and nanoseconds\nfunction getCurrentTime() {\n  const now = new Date();\n  const seconds = Math.floor(now.getTime() / 1000);\n  const nanos = (now.getTime() % 1000) * 1e6; // convert remaining milliseconds to nanoseconds\n  return {\n    seconds: seconds,\n    nanos: nanos,\n  };\n}\n\n//function to convert days into google duration\nfunction daysToDuration(days) {\n    const SECONDS_IN_A_DAY = 86400;\n    \n    // Convert days to total seconds\n    let totalSeconds = days * SECONDS_IN_A_DAY;\n    \n    return {\n        seconds: totalSeconds,\n        nanos: 0\n    };\n}\n\nfunction stringToUUID(str) {\n  function s4(hash) {\n    return Math.floor((1 + hash) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n\n  // Split hash into parts and use them to format UUID\n  return (\n    s4(hash & 0xffff) +\n    s4((hash >>> 16) & 0xffff) +\n    \"-\" +\n    s4(hash & 0xffff) +\n    \"-\" +\n    s4((hash >>> 16) & 0xffff) +\n    \"-\" +\n    s4(hash & 0xffff) +\n    \"-\" +\n    s4(hash & 0xffff) +\n    s4((hash >>> 16) & 0xffff)\n  );\n}\n\nconst rewardTypeEnum = {\n    \"REWARD_TYPE_INVALID\": 0,\n    \"REWARD_TYPE_OFFER\": 1,\n    \"REWARD_TYPE_LOYALTY_SUBSCRIPTION\": 2,\n};\n\nlet benefitData;\n\nif (rewardType === \"REWARD_TYPE_OFFER\") {\n    benefitData = {\n        reward_type: rewardTypeEnum[rewardType],\n        offer_data: {\n            template_id: rewardOfferTemplateId,\n            offer_duration: daysToDuration(rewardDuration),\n            marketplace_context: {\n              marketplace_id: \"SWIGGY_IN\",\n              business_line_id: rewardBusinessLine,\n            }\n        }\n    };\n} else if (rewardType === \"REWARD_TYPE_LOYALTY_SUBSCRIPTION\") {\n    benefitData = {\n        reward_type: rewardTypeEnum[rewardType],\n        swiggy_one_data: {\n            plan_id: rewardOfferTemplateId,\n            plan_duration: daysToDuration(rewardDuration)\n        }\n    };\n} else {\n    benefitData = {\n        reward_type: rewardTypeEnum[\"REWARD_TYPE_INVALID\"]\n    };\n}\n\nconst rewardData = {\n  reward_name: rewardName,\n  reward_description: rewardDescription,\n  reward_data: {\n    benefit_data: benefitData,\n    reward_presentation_data: [\n      {\n        info_type: 1, // PRESENTATION_INFO_TYPE_LOCKED\n        title: rewardLockedHeading,\n        description: rewardLockedDescription,\n        cta: {\n          text: rewardLockedCtaCallout,\n          link: rewardLockedCtaLink,\n        },\n      },\n      {\n        info_type: 2, // PRESENTATION_INFO_TYPE_UNLOCKED\n        title: rewardUnlockedHeading,\n        description: rewardUnlockedDescription,\n        cta: {\n          text: rewardUnlockedCtaCallout,\n          link: rewardUnlockedCtaLink,\n        },\n      },\n      {\n        info_type: 3, // PRESENTATION_INFO_TYPE_EXPIRED\n        title: rewardExpiredHeading,\n        description: rewardExpiredDescription,\n        cta: {\n          text: rewardExpiredCtaCallout,\n          link: rewardExpiredCtaLink,\n        },\n      },\n      {\n        info_type: 4, // PRESENTATION_INFO_TYPE_REDEEMED\n        title: rewardRedeemedHeading,\n        description: rewardRedeemedDescription,\n        cta: {\n          text: rewardRedeemedCtaCallout,\n          link: rewardRedeemedCtaLink,\n        },\n      },\n    ],\n  },\n};\n\nconst jsonData = {\n  request_context: {\n    request_id: generateUUID(),\n    request_time: getCurrentTime(),\n    client_id: stringToUUID(\"Marketing Dashboard\"),\n    channel: \"SWIGGY\",\n  },\n  market_place_context: {\n    marketplace_id: \"SWIGGY_IN\",\n    business_line_id: \"INSTAMART\",\n  },\n  milestone_reward: rewardData,\n  created_by: current_user.email,\n};\n\n\nreturn JSON.stringify(jsonData);\n",
    "parameters": [],
    "runOnPageLoad": false
  },
  "dataSourceId": "424c9bde-1c88-4787-af40-e905d3ecfd6c",
  "appVersionId": "d74f28e3-ec1b-4ff9-b6e6-b777a4e48b56"
}